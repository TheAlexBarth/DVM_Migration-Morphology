---
title: DVM and Daytime depth model
---

```{r}
  # rm(list = ls())
  # library(EcotaxaTools)
  # library(ggplot2)
  # library(ggpubr)
  # library(lubridate)
  # library(mgcv)
  # source('../R/tools.R')
  # 
  # # |- load in data ---------------------------------------------
  # wmd_data <- readRDS('../data/04_wmd-by-cruise-seasonal.rds')
  # # |- format wmd CIs for each cruise --------------------------
  # wmd_df <- wmd_df_construct(wmd_data,'season')
  # 
  # sat_data <- readRDS('../data/05_modis-month-sum.rds')
  # 
  # sat_data$season <- sapply(sat_data$Date, season_assign)
  # sat_data <- sat_data |> 
  #   group_by(season) |> 
  #   summarize(par = mean(par,na.rm =T),
  #             dwi = mean(dwi, na.rm = T))
  # 
  # part_data <- readRDS('../data/05_cast-metrics.rds')
  # 
  # for(i in 1:10000) {
  #   print("INCOMPLETE")
  # }
  # 
  # stop('dubmmy')
  # 
  # part_data <- part_data[order(part_data$profileid, uvp_data_meta$profileid),]
  # part_data$cruise_id <- uvp_data_meta$cruise_id
  # part_data_cruise <- part_data |> 
  #   group_by(cruise_id) |> 
  #   summarise(dcm_d = mean(dcm_d,na.rm = T),
  #             intg_part = mean(intg_part, na.rm = T))
  # 
  # # |- format wmd CIs for each cruise --------------------------
  # wmd_df <- wmd_df_construct(wmd_data,'cruise')
  # wmd_df$date <- wmd_df$date |> as.Date(origin = '1970-01-01')
  # 
  # # |- pull all together ----------------------------
  # full_data <- wmd_df
  # full_data$par <- rep(NA,nrow(full_data))
  # full_data$dwi <- rep(NA, nrow(full_data))
  # full_data$dcm_d <- rep(NA,nrow(full_data))
  # full_data$part250 <- rep(NA,nrow(full_data))
  # 
  # for(i in 1:length(unique(full_data$cruise_id))) {
  #   cruise <-  unique(full_data$cruise_id)[i]
  #   full_idx <- which(full_data$cruise_id == cruise)
  #   part_idx <- which(part_data_cruise$cruise_id == cruise)
  #   date <- full_data$date[full_idx] |> unique()
  #   sat_idx <- which(sat_data$Date == date)
  #   
  #   full_data$par[full_idx] <- sat_data$par[sat_idx]
  #   full_data$dwi[full_idx] <- sat_data$dwi[sat_idx]
  #   full_data$dcm_d[full_idx] <- part_data_cruise$dcm_d[part_idx]
  #   full_data$part250[full_idx] <- part_data_cruise$intg_part[part_idx]
  #}
```