<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-99.9.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Migrator Morphology - Weighted Mean Depth of Morphological Groups</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="site_libs/htmlwidgets-1.6.1/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.26/datatables.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Migrator Morphology</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html">Home</a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-main-analyses" role="button" data-bs-toggle="dropdown" aria-expanded="false">Main Analyses</a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-main-analyses">    
        <li>
    <a class="dropdown-item" href="./main_00_CTD-UVP-map.html">
 <span class="dropdown-text">Sampling Region</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./main_01_ctd_interp.html">
 <span class="dropdown-text">Physical Backdrop</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./main_02_PC-Clusters.html">
 <span class="dropdown-text">PCA-Morphogroup clustering</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./main_03_Vert-Distrib.html">
 <span class="dropdown-text">Vertical Profiles of MGs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./main_04_WMD-by-morphogroup.html">
 <span class="dropdown-text">Weighted Mean Depth of Morphogroups</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-supplemental" role="button" data-bs-toggle="dropdown" aria-expanded="false">Supplemental</a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-supplemental">    
        <li>
    <a class="dropdown-item" href="./supp_01_ctd-by-cruise.html">
 <span class="dropdown-text">CTD by Cruise</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./supp_02_pc-extended-info.html">
 <span class="dropdown-text">Extended PCA/Clustering Plots</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./supp_03_cluster-conc.qmd">
 <span class="dropdown-text">Integrated Abundancy by Morphogroup</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/TheAlexBarth/DMV_BATS"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://thealexbarth.github.io/#about"><i class="bi bi-house-fill" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Weighted Mean Depth of Morphological Groups</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="methodology" class="level2">
<h2 class="anchored" data-anchor-id="methodology">Methodology</h2>
<p>Weighted mean depth is a commonly used metric to describe zooplankton populations and vertical distributions. Zooplankton populations can often be found in bimodal patterns throughout the water column, with a subsurface peak and a deeper mesopelagic peak <a href="./main_03_Vert-Distrib.html">see here</a>. The WMD of a distribution effectively provides a center of mass for the zooplankton in the water column. However, interpreting the WMD often requires context as the depth itself may not be informative. WMD can be particularly useful for DVM studies, as it can show the differences in daytime and nighttime distributions <a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/lno.10251">Ohman &amp; Romagnan 2016</a>. Additionally, by calculating the average WMD across multiple samples, the variability (or standard deviation) in WMD can be informative to the overall spread of the zooplankton distribution throughout the water column.</p>
<p>In this study, because profiles extend to different depths and sampling effort (volume) is inconsistent between profiles directly calculating the average WMD is not feasible. However, understanding variation around the WMD is necessary to interpret the vertical structure and strength of DVM. Here, we took a depth-bin constrained bootstrap approach to define WMD with a confidence interval. To do this, the concentration of each group, was calculated in 20m depth bin for each profile. Then all profiles from the same time of day were ‘pooled’. This provides a distribution of concentrations in each depth bin. Traditional bootstrapping randomly samples with replacement from all observations. With vertically structured data however, full random sampling would bias estimates towards the surface, where there were more profiles. To avoid this, samples were “bin-constrained” such that for each iteration, a random observation was sampled within each depth bin, then replaced for the next iteration. A maximum depth was set to 600m, as it is unlikely that copepods are migrated beyond this depth (See figure 3). This approach then effectively created a random profile by resampling a concentration, <span class="math inline">\(conc^*\)</span>, from each depth bin, <span class="math inline">\(d\)</span>. This profile then was used to calculate a bootstrapped weighted mean depth, <span class="math inline">\(WMD^*\)</span>. This was done for each morphological group <span class="math inline">\(g\)</span>, at each time of day <span class="math inline">\(t\)</span> (<span class="math inline">\(\ref{Equation 1}\)</span>).</p>
<p><span class="math display">\[\begin{align}
  $WMD^*_{g,t} = \sum_{i}^{N = 60}{\frac{d_i(conc^*_{i,g,t})}{\sum_i^{N = 60}{conc^*_{i,g,t}}}}$ \label{Equation 1}
\end{align}\]</span></p>
<p>The distribution of <span class="math inline">\(WMD^*_{g,t}\)</span> then was used to calculate a bootstrapped mean and 95% confidence interval. Then, the confidence intervals could be compared between times of day and morphological groups to assess the strength of DVM. This approach was used to investigate the DVM hypotheses related to size and transparency. Using PC1 to assess size, the WMD was compared between the three PC1-groups by percentile level. Then to assess the effect of transparency, while accounting for size, the WMD was compared between PC2-groups for each PC1-grouping.</p>
<p>From the visual detection hypothesis, it is predicted that larger and darker copepods will have a larger signal of DVM. A larger signal of DVM would be evident by a clearly deeper (non-overlapping 95% CI) daytime WMD.</p>
</section>
<section id="key-figures-and-takeaways" class="level2">
<h2 class="anchored" data-anchor-id="key-figures-and-takeaways">Key Figures and Takeaways</h2>
<p>For the size assessment, there was a clear signal of DVM across all groups. All the daytime confidence intervals were deeper and non-overlapping with the nighttime intervals. However, the depth of the daytime WMD was different across PC1-groups. The low group had the shallowest WMD (95% CI: [235.2,296.0m]), followed by the middle group (95% CI: [309.0,347.1m]), then the high group (95% CI: [352.3,405.0m]). This pattern provides strong support for the size-dependent DVM hypothesis. The larger a copepod is, the deeper it must migrate during the daytime to avoid visual detection.</p>
<p>For the influence of transparency, the effect is only clear amongst large (high-PC1 group). For the low-PC1 and mid-PC1 groups, the daytime WMD 95% CI’s are overlapping for all levels of PC2-groups. However, within the larger copepods (high PC1-group), there was a clear signal of weaker DVM by lighter (low PC2-group) copepods. The mid-PC2 and high-PC2 groups had deeper, yet overlapping, daytime 95%CIs. This suggests that some larger copepods can escape the DVM burden through maintaining transparency.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">'../r/tools.R'</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>boot_wmd <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">'../data/03b_alt-mg-wmd-bins.rds'</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># |- Summarize DF -----------------------</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>summarize_wmd <span class="ot">&lt;-</span> <span class="cf">function</span>(wmd_group) {</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  day_summary <span class="ot">&lt;-</span> wmd_group<span class="sc">$</span>day <span class="sc">|&gt;</span> </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lapply</span>(quantile, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.5</span>,.<span class="dv">975</span>))</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  night_summary <span class="ot">&lt;-</span> wmd_group<span class="sc">$</span>night <span class="sc">|&gt;</span> </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lapply</span>(quantile, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.5</span>,<span class="fl">0.975</span>))</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  wmd_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'low'</span>,<span class="st">'mid'</span>,<span class="st">'high'</span>), <span class="at">each =</span> <span class="dv">2</span>),</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>                       <span class="at">tod =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'day'</span>,<span class="st">'night'</span>), <span class="at">times =</span> <span class="dv">3</span>),</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>                       <span class="at">lbound =</span> <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span>),</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mean =</span> <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span>),</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>                       <span class="at">hbound =</span> <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span>))</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(group <span class="cf">in</span> <span class="fu">c</span>(<span class="st">'low'</span>,<span class="st">'mid'</span>,<span class="st">'high'</span>)) {</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    wmd_df[[<span class="st">'lbound'</span>]][<span class="fu">which</span>(wmd_df[[<span class="st">'tod'</span>]] <span class="sc">==</span> <span class="st">'day'</span> <span class="sc">&amp;</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>                               wmd_df[[<span class="st">'group'</span>]] <span class="sc">==</span> group)] <span class="ot">&lt;-</span> day_summary[[group]][[<span class="st">'2.5%'</span>]]</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    wmd_df[[<span class="st">'mean'</span>]][<span class="fu">which</span>(wmd_df[[<span class="st">'tod'</span>]] <span class="sc">==</span> <span class="st">'day'</span> <span class="sc">&amp;</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>                               wmd_df[[<span class="st">'group'</span>]] <span class="sc">==</span> group)] <span class="ot">&lt;-</span> <span class="fu">mean</span>(wmd_group<span class="sc">$</span>day[[group]])</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    wmd_df[[<span class="st">'hbound'</span>]][<span class="fu">which</span>(wmd_df[[<span class="st">'tod'</span>]] <span class="sc">==</span> <span class="st">'day'</span> <span class="sc">&amp;</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>                               wmd_df[[<span class="st">'group'</span>]] <span class="sc">==</span> group)] <span class="ot">&lt;-</span> day_summary[[group]][[<span class="st">'97.5%'</span>]]</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    wmd_df[[<span class="st">'lbound'</span>]][<span class="fu">which</span>(wmd_df[[<span class="st">'tod'</span>]] <span class="sc">==</span> <span class="st">'night'</span> <span class="sc">&amp;</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>                               wmd_df[[<span class="st">'group'</span>]] <span class="sc">==</span> group)] <span class="ot">&lt;-</span> night_summary[[group]][[<span class="st">'2.5%'</span>]]</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    wmd_df[[<span class="st">'mean'</span>]][<span class="fu">which</span>(wmd_df[[<span class="st">'tod'</span>]] <span class="sc">==</span> <span class="st">'night'</span> <span class="sc">&amp;</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>                               wmd_df[[<span class="st">'group'</span>]] <span class="sc">==</span> group)] <span class="ot">&lt;-</span> <span class="fu">mean</span>(wmd_group<span class="sc">$</span>night[[group]])</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    wmd_df[[<span class="st">'hbound'</span>]][<span class="fu">which</span>(wmd_df[[<span class="st">'tod'</span>]] <span class="sc">==</span> <span class="st">'night'</span> <span class="sc">&amp;</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>                               wmd_df[[<span class="st">'group'</span>]] <span class="sc">==</span> group)] <span class="ot">&lt;-</span> night_summary[[group]][[<span class="st">'97.5%'</span>]]</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  wmd_df<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(wmd_df<span class="sc">$</span>group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'low'</span>,<span class="st">'mid'</span>,<span class="st">'high'</span>))</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(wmd_df)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>pc1_wmd_df <span class="ot">&lt;-</span> boot_wmd<span class="sc">$</span>pc1 <span class="sc">|&gt;</span> <span class="fu">summarize_wmd</span>()</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pc1_wmd_df) <span class="sc">+</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> group,</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> mean,</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> tod),</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> .<span class="dv">5</span>),</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">x =</span> group,</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymin =</span> lbound,</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> hbound,</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color =</span> tod),</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> .<span class="dv">25</span>,</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> .<span class="dv">5</span>),</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(dn_cols[<span class="st">'day'</span>],dn_cols[<span class="st">'night'</span>])) <span class="sc">+</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">600</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Depth [m]'</span>, <span class="at">x =</span> <span class="st">'PC1 Level Groups'</span>, <span class="at">col =</span> <span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="main_04_WMD-by-morphogroup_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="302"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(pc1_wmd_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;">group</th>
<th style="text-align: left;">tod</th>
<th style="text-align: right;">lbound</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">hbound</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">low</td>
<td style="text-align: left;">day</td>
<td style="text-align: right;">235.1989</td>
<td style="text-align: right;">265.1734</td>
<td style="text-align: right;">295.9534</td>
</tr>
<tr class="even">
<td style="text-align: left;">low</td>
<td style="text-align: left;">night</td>
<td style="text-align: right;">148.8018</td>
<td style="text-align: right;">168.8790</td>
<td style="text-align: right;">190.6532</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mid</td>
<td style="text-align: left;">day</td>
<td style="text-align: right;">308.9897</td>
<td style="text-align: right;">327.7383</td>
<td style="text-align: right;">347.3109</td>
</tr>
<tr class="even">
<td style="text-align: left;">mid</td>
<td style="text-align: left;">night</td>
<td style="text-align: right;">143.4335</td>
<td style="text-align: right;">158.9165</td>
<td style="text-align: right;">176.3030</td>
</tr>
<tr class="odd">
<td style="text-align: left;">high</td>
<td style="text-align: left;">day</td>
<td style="text-align: right;">352.2630</td>
<td style="text-align: right;">378.8520</td>
<td style="text-align: right;">404.9709</td>
</tr>
<tr class="even">
<td style="text-align: left;">high</td>
<td style="text-align: left;">night</td>
<td style="text-align: right;">167.0618</td>
<td style="text-align: right;">191.9661</td>
<td style="text-align: right;">219.3338</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Observe for PC2 breaks by PC1 group</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>small_pc2 <span class="ot">&lt;-</span> boot_wmd<span class="sc">$</span>pc2_sm <span class="sc">|&gt;</span> <span class="fu">summarize_wmd</span>()</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>mid_pc2 <span class="ot">&lt;-</span> boot_wmd<span class="sc">$</span>pc2_mid <span class="sc">|&gt;</span> <span class="fu">summarize_wmd</span>()</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>lg_pc2 <span class="ot">&lt;-</span> boot_wmd<span class="sc">$</span>pc2_lg <span class="sc">|&gt;</span> <span class="fu">summarize_wmd</span>()</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>pc2_plotter <span class="ot">&lt;-</span> <span class="cf">function</span>(wmd, pc1_group){</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(wmd) <span class="sc">+</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> group,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> mean,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> tod),</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> .<span class="dv">5</span>),</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">x =</span> group,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ymin =</span> lbound,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ymax =</span> hbound,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>                      <span class="at">color =</span> tod),</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> .<span class="dv">25</span>,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>                  <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> .<span class="dv">5</span>),</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(dn_cols[<span class="st">'day'</span>],dn_cols[<span class="st">'night'</span>])) <span class="sc">+</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reverse</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">600</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Depth [m]'</span>, <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">'PC2 Level Groups'</span>,<span class="st">'</span><span class="sc">\n</span><span class="st">'</span>,pc1_group), <span class="at">col =</span> <span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_pubr</span>()</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>sm_plot <span class="ot">&lt;-</span> <span class="fu">pc2_plotter</span>(small_pc2, <span class="st">'Small PC1'</span>)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>mid_plot <span class="ot">&lt;-</span> <span class="fu">pc2_plotter</span>(mid_pc2, <span class="st">'Mid PC1'</span>)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>lg_plot <span class="ot">&lt;-</span> <span class="fu">pc2_plotter</span>(lg_pc2, <span class="st">'Large PC1'</span>)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(sm_plot, mid_plot, lg_plot,</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">common.legend =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="main_04_WMD-by-morphogroup_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="302"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(small_pc2, <span class="at">caption =</span> <span class="st">'Small PC1 - PC2 Groups'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-d4f6ee1801772b5c8e6d" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-d4f6ee1801772b5c8e6d">{"x":{"filter":"none","vertical":false,"caption":"<caption>Small PC1 - PC2 Groups<\/caption>","data":[["1","2","3","4","5","6"],["low","low","mid","mid","high","high"],["day","night","day","night","day","night"],[202.607483800761,91.3210038637753,210.100449290847,122.548853159966,236.669392208573,178.684581056948],[268.71089942106,145.537191672821,254.58442994705,148.466827168097,279.921547059503,224.30597031043],[337.325386089737,207.025546504951,304.550057591648,177.140128840454,320.377647513459,269.888019993133]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>group<\/th>\n      <th>tod<\/th>\n      <th>lbound<\/th>\n      <th>mean<\/th>\n      <th>hbound<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(mid_pc2, <span class="at">caption =</span> <span class="st">'Mid PC1 - PC2 Groups'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-aa81e90c13b7fe58f8e4" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-aa81e90c13b7fe58f8e4">{"x":{"filter":"none","vertical":false,"caption":"<caption>Mid PC1 - PC2 Groups<\/caption>","data":[["1","2","3","4","5","6"],["low","low","mid","mid","high","high"],["day","night","day","night","day","night"],[263.441306133042,121.576397154983,323.75831424931,139.452537638086,269.020940218319,133.869894905027],[297.454622483713,147.697169428291,350.237746803707,160.816725282565,329.018953535627,166.506413056005],[331.438650188723,175.765748353661,374.81473240253,181.509936795028,385.128428873788,200.854010512467]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>group<\/th>\n      <th>tod<\/th>\n      <th>lbound<\/th>\n      <th>mean<\/th>\n      <th>hbound<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(lg_pc2, <span class="at">caption =</span> <span class="st">'Large PC1 - PC2 Groups'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-0ab65ebdc2929bd70439" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-0ab65ebdc2929bd70439">{"x":{"filter":"none","vertical":false,"caption":"<caption>Large PC1 - PC2 Groups<\/caption>","data":[["1","2","3","4","5","6"],["low","low","mid","mid","high","high"],["day","night","day","night","day","night"],[235.394462758128,162.018185593269,377.71290050989,142.403128365269,390.666046157224,139.96835194699],[291.471309776624,219.942295453411,414.556835060812,184.543909957032,428.066495333083,180.417456468203],[348.822774738639,275.821244728893,446.823141160933,225.749118535623,469.208849404371,225.56140684806]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>group<\/th>\n      <th>tod<\/th>\n      <th>lbound<\/th>\n      <th>mean<\/th>\n      <th>hbound<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb7" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> Weighted Mean Depth of Morphological Groups</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">## Methodology</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>Weighted mean depth is a commonly used metric to describe zooplankton populations and vertical distributions. Zooplankton populations can often be found in bimodal patterns throughout the water column, with a subsurface peak and a deeper mesopelagic peak <span class="co">[</span><span class="ot">see here</span><span class="co">](./main_03_Vert-Distrib.html)</span>. The WMD of a distribution effectively provides a center of mass for the zooplankton in the water column. However, interpreting the WMD often requires context as the depth itself may not be informative. WMD can be particularly useful for DVM studies, as it can show the differences in daytime and nighttime distributions <span class="co">[</span><span class="ot">Ohman &amp; Romagnan 2016</span><span class="co">](https://onlinelibrary.wiley.com/doi/abs/10.1002/lno.10251)</span>. Additionally, by calculating the average WMD across multiple samples, the variability (or standard deviation) in WMD can be informative to the overall spread of the zooplankton distribution throughout the water column.</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>\n\n</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>In this study, because profiles extend to different depths and sampling effort (volume) is inconsistent between profiles directly calculating the average WMD is not feasible. However, understanding variation around the WMD is necessary to interpret the vertical structure and strength of DVM. Here, we took a depth-bin constrained bootstrap approach to define WMD with a confidence interval. To do this, the concentration of each group, was calculated in 20m depth bin for each profile. Then all profiles from the same time of day were 'pooled'. This provides a distribution of concentrations in each depth bin. Traditional bootstrapping randomly samples with replacement from all observations. With vertically structured data however, full random sampling would bias estimates towards the surface, where there were more profiles. To avoid this, samples were "bin-constrained" such that for each iteration, a random observation was sampled within each depth bin, then replaced for the next iteration. A maximum depth was set to 600m, as it is unlikely that copepods are migrated beyond this depth (See figure 3). This approach then effectively created a random profile by resampling a concentration, $conc^*$, from each depth bin, $d$. This profile then was used to calculate a bootstrapped weighted mean depth, $WMD^*$. This was done for each morphological group $g$, at each time of day $t$ (\ref{Equation 1}).</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  $WMD^*_{g,t} = \sum_{i}^{N = 60}{\frac{d_i(conc^*_{i,g,t})}{\sum_i^{N = 60}{conc^*_{i,g,t}}}}$ \label{Equation 1}</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>The distribution of $WMD^*_{g,t}$ then was used to calculate a bootstrapped mean and 95% confidence interval. Then, the confidence intervals could be compared between times of day and morphological groups to assess the strength of DVM. This approach was used to investigate the DVM hypotheses related to size and transparency. Using PC1 to assess size, the WMD was compared between the three PC1-groups by percentile level. Then to assess the effect of transparency, while accounting for size, the WMD was compared between PC2-groups for each PC1-grouping.</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>From the visual detection hypothesis, it is predicted that larger and darker copepods will have a larger signal of DVM. A larger signal of DVM would be evident by a clearly deeper (non-overlapping 95% CI) daytime WMD.</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="fu">## Key Figures and Takeaways</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>For the size assessment, there was a clear signal of DVM across all groups. All the daytime confidence intervals were deeper and non-overlapping with the nighttime intervals. However, the depth of the daytime WMD was different across PC1-groups. The low group had the shallowest WMD (95% CI: <span class="co">[</span><span class="ot">235.2,296.0m</span><span class="co">]</span>), followed by the middle group (95% CI: <span class="co">[</span><span class="ot">309.0,347.1m</span><span class="co">]</span>), then the high group (95% CI: <span class="co">[</span><span class="ot">352.3,405.0m</span><span class="co">]</span>). This pattern provides strong support for the size-dependent DVM hypothesis. The larger a copepod is, the deeper it must migrate during the daytime to avoid visual detection. </span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>For the influence of transparency, the effect is only clear amongst large (high-PC1 group). For the low-PC1 and mid-PC1 groups, the daytime WMD 95% CI's are overlapping for all levels of PC2-groups. However, within the larger copepods (high PC1-group), there was a clear signal of weaker DVM by lighter (low PC2-group) copepods. The mid-PC2 and high-PC2 groups had deeper, yet overlapping, daytime 95%CIs. This suggests that some larger copepods can escape the DVM burden through maintaining transparency.</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>\n\n</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=3.15, fig.height=1.57}</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">'../r/tools.R'</span>)</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>boot_wmd <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">'../data/03b_alt-mg-wmd-bins.rds'</span>)</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a><span class="co"># |- Summarize DF -----------------------</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>summarize_wmd <span class="ot">&lt;-</span> <span class="cf">function</span>(wmd_group) {</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>  day_summary <span class="ot">&lt;-</span> wmd_group<span class="sc">$</span>day <span class="sc">|&gt;</span> </span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lapply</span>(quantile, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.5</span>,.<span class="dv">975</span>))</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>  night_summary <span class="ot">&lt;-</span> wmd_group<span class="sc">$</span>night <span class="sc">|&gt;</span> </span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lapply</span>(quantile, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.5</span>,<span class="fl">0.975</span>))</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>  wmd_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'low'</span>,<span class="st">'mid'</span>,<span class="st">'high'</span>), <span class="at">each =</span> <span class="dv">2</span>),</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>                       <span class="at">tod =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'day'</span>,<span class="st">'night'</span>), <span class="at">times =</span> <span class="dv">3</span>),</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>                       <span class="at">lbound =</span> <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span>),</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mean =</span> <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span>),</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>                       <span class="at">hbound =</span> <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span>))</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(group <span class="cf">in</span> <span class="fu">c</span>(<span class="st">'low'</span>,<span class="st">'mid'</span>,<span class="st">'high'</span>)) {</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>    wmd_df[[<span class="st">'lbound'</span>]][<span class="fu">which</span>(wmd_df[[<span class="st">'tod'</span>]] <span class="sc">==</span> <span class="st">'day'</span> <span class="sc">&amp;</span></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>                               wmd_df[[<span class="st">'group'</span>]] <span class="sc">==</span> group)] <span class="ot">&lt;-</span> day_summary[[group]][[<span class="st">'2.5%'</span>]]</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>    wmd_df[[<span class="st">'mean'</span>]][<span class="fu">which</span>(wmd_df[[<span class="st">'tod'</span>]] <span class="sc">==</span> <span class="st">'day'</span> <span class="sc">&amp;</span></span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>                               wmd_df[[<span class="st">'group'</span>]] <span class="sc">==</span> group)] <span class="ot">&lt;-</span> <span class="fu">mean</span>(wmd_group<span class="sc">$</span>day[[group]])</span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>    wmd_df[[<span class="st">'hbound'</span>]][<span class="fu">which</span>(wmd_df[[<span class="st">'tod'</span>]] <span class="sc">==</span> <span class="st">'day'</span> <span class="sc">&amp;</span></span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>                               wmd_df[[<span class="st">'group'</span>]] <span class="sc">==</span> group)] <span class="ot">&lt;-</span> day_summary[[group]][[<span class="st">'97.5%'</span>]]</span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>    wmd_df[[<span class="st">'lbound'</span>]][<span class="fu">which</span>(wmd_df[[<span class="st">'tod'</span>]] <span class="sc">==</span> <span class="st">'night'</span> <span class="sc">&amp;</span></span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>                               wmd_df[[<span class="st">'group'</span>]] <span class="sc">==</span> group)] <span class="ot">&lt;-</span> night_summary[[group]][[<span class="st">'2.5%'</span>]]</span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>    wmd_df[[<span class="st">'mean'</span>]][<span class="fu">which</span>(wmd_df[[<span class="st">'tod'</span>]] <span class="sc">==</span> <span class="st">'night'</span> <span class="sc">&amp;</span></span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>                               wmd_df[[<span class="st">'group'</span>]] <span class="sc">==</span> group)] <span class="ot">&lt;-</span> <span class="fu">mean</span>(wmd_group<span class="sc">$</span>night[[group]])</span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>    wmd_df[[<span class="st">'hbound'</span>]][<span class="fu">which</span>(wmd_df[[<span class="st">'tod'</span>]] <span class="sc">==</span> <span class="st">'night'</span> <span class="sc">&amp;</span></span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>                               wmd_df[[<span class="st">'group'</span>]] <span class="sc">==</span> group)] <span class="ot">&lt;-</span> night_summary[[group]][[<span class="st">'97.5%'</span>]]</span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>  wmd_df<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(wmd_df<span class="sc">$</span>group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'low'</span>,<span class="st">'mid'</span>,<span class="st">'high'</span>))</span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(wmd_df)</span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>pc1_wmd_df <span class="ot">&lt;-</span> boot_wmd<span class="sc">$</span>pc1 <span class="sc">|&gt;</span> <span class="fu">summarize_wmd</span>()</span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pc1_wmd_df) <span class="sc">+</span></span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> group,</span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> mean,</span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> tod),</span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> .<span class="dv">5</span>),</span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">x =</span> group,</span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymin =</span> lbound,</span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> hbound,</span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color =</span> tod),</span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> .<span class="dv">25</span>,</span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> .<span class="dv">5</span>),</span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(dn_cols[<span class="st">'day'</span>],dn_cols[<span class="st">'night'</span>])) <span class="sc">+</span></span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">600</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Depth [m]'</span>, <span class="at">x =</span> <span class="st">'PC1 Level Groups'</span>, <span class="at">col =</span> <span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb7-95"><a href="#cb7-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>()</span>
<span id="cb7-96"><a href="#cb7-96" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-97"><a href="#cb7-97" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(pc1_wmd_df)</span>
<span id="cb7-98"><a href="#cb7-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-99"><a href="#cb7-99" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-100"><a href="#cb7-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-101"><a href="#cb7-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-102"><a href="#cb7-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-103"><a href="#cb7-103" aria-hidden="true" tabindex="-1"></a>Observe for PC2 breaks by PC1 group</span>
<span id="cb7-104"><a href="#cb7-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-105"><a href="#cb7-105" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=3.15, fig.height=1.57}</span></span>
<span id="cb7-106"><a href="#cb7-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-107"><a href="#cb7-107" aria-hidden="true" tabindex="-1"></a>small_pc2 <span class="ot">&lt;-</span> boot_wmd<span class="sc">$</span>pc2_sm <span class="sc">|&gt;</span> <span class="fu">summarize_wmd</span>()</span>
<span id="cb7-108"><a href="#cb7-108" aria-hidden="true" tabindex="-1"></a>mid_pc2 <span class="ot">&lt;-</span> boot_wmd<span class="sc">$</span>pc2_mid <span class="sc">|&gt;</span> <span class="fu">summarize_wmd</span>()</span>
<span id="cb7-109"><a href="#cb7-109" aria-hidden="true" tabindex="-1"></a>lg_pc2 <span class="ot">&lt;-</span> boot_wmd<span class="sc">$</span>pc2_lg <span class="sc">|&gt;</span> <span class="fu">summarize_wmd</span>()</span>
<span id="cb7-110"><a href="#cb7-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-111"><a href="#cb7-111" aria-hidden="true" tabindex="-1"></a>pc2_plotter <span class="ot">&lt;-</span> <span class="cf">function</span>(wmd, pc1_group){</span>
<span id="cb7-112"><a href="#cb7-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(wmd) <span class="sc">+</span></span>
<span id="cb7-113"><a href="#cb7-113" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> group,</span>
<span id="cb7-114"><a href="#cb7-114" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> mean,</span>
<span id="cb7-115"><a href="#cb7-115" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> tod),</span>
<span id="cb7-116"><a href="#cb7-116" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> .<span class="dv">5</span>),</span>
<span id="cb7-117"><a href="#cb7-117" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb7-118"><a href="#cb7-118" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">x =</span> group,</span>
<span id="cb7-119"><a href="#cb7-119" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ymin =</span> lbound,</span>
<span id="cb7-120"><a href="#cb7-120" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ymax =</span> hbound,</span>
<span id="cb7-121"><a href="#cb7-121" aria-hidden="true" tabindex="-1"></a>                      <span class="at">color =</span> tod),</span>
<span id="cb7-122"><a href="#cb7-122" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> .<span class="dv">25</span>,</span>
<span id="cb7-123"><a href="#cb7-123" aria-hidden="true" tabindex="-1"></a>                  <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> .<span class="dv">5</span>),</span>
<span id="cb7-124"><a href="#cb7-124" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb7-125"><a href="#cb7-125" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(dn_cols[<span class="st">'day'</span>],dn_cols[<span class="st">'night'</span>])) <span class="sc">+</span></span>
<span id="cb7-126"><a href="#cb7-126" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reverse</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">600</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb7-127"><a href="#cb7-127" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Depth [m]'</span>, <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">'PC2 Level Groups'</span>,<span class="st">'</span><span class="sc">\n</span><span class="st">'</span>,pc1_group), <span class="at">col =</span> <span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb7-128"><a href="#cb7-128" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_pubr</span>()</span>
<span id="cb7-129"><a href="#cb7-129" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-130"><a href="#cb7-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-131"><a href="#cb7-131" aria-hidden="true" tabindex="-1"></a>sm_plot <span class="ot">&lt;-</span> <span class="fu">pc2_plotter</span>(small_pc2, <span class="st">'Small PC1'</span>)</span>
<span id="cb7-132"><a href="#cb7-132" aria-hidden="true" tabindex="-1"></a>mid_plot <span class="ot">&lt;-</span> <span class="fu">pc2_plotter</span>(mid_pc2, <span class="st">'Mid PC1'</span>)</span>
<span id="cb7-133"><a href="#cb7-133" aria-hidden="true" tabindex="-1"></a>lg_plot <span class="ot">&lt;-</span> <span class="fu">pc2_plotter</span>(lg_pc2, <span class="st">'Large PC1'</span>)</span>
<span id="cb7-134"><a href="#cb7-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-135"><a href="#cb7-135" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(sm_plot, mid_plot, lg_plot,</span>
<span id="cb7-136"><a href="#cb7-136" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">common.legend =</span> T)</span>
<span id="cb7-137"><a href="#cb7-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-138"><a href="#cb7-138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-139"><a href="#cb7-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-142"><a href="#cb7-142" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb7-143"><a href="#cb7-143" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(small_pc2, <span class="at">caption =</span> <span class="st">'Small PC1 - PC2 Groups'</span>)</span>
<span id="cb7-144"><a href="#cb7-144" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(mid_pc2, <span class="at">caption =</span> <span class="st">'Mid PC1 - PC2 Groups'</span>)</span>
<span id="cb7-145"><a href="#cb7-145" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(lg_pc2, <span class="at">caption =</span> <span class="st">'Large PC1 - PC2 Groups'</span>)</span>
<span id="cb7-146"><a href="#cb7-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-147"><a href="#cb7-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-148"><a href="#cb7-148" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>