<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-99.9.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Migrator Morphology - Morphogroup Occupancy Model</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="site_libs/htmlwidgets-1.6.1/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.26/datatables.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
<link href="site_libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="site_libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="site_libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="site_libs/selectize-0.12.0/selectize.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Migrator Morphology</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html">Home</a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-main-analyses" role="button" data-bs-toggle="dropdown" aria-expanded="false">Main Analyses</a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-main-analyses">    
        <li>
    <a class="dropdown-item" href="./main_00_CTD-UVP-map.html">
 <span class="dropdown-text">Sampling Region</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./main_01_ctd_interp.html">
 <span class="dropdown-text">Physical Backdrop</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./main_02_PC-Clusters.html">
 <span class="dropdown-text">PCA-Morphogroup clustering</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./main_03_Vert-Distrib.html">
 <span class="dropdown-text">Vertical Profiles of MGs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./main_04_WMD-by-morphogroup.html">
 <span class="dropdown-text">Weighted Mean Depth of Morphogroups</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./main_05_all-copepod-occupancy.html">
 <span class="dropdown-text">All Copepod Occupancy Model</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./main_06_cluster-occurence.html">
 <span class="dropdown-text">Occupancy by Morphogroup</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./main_07_environmental-effect-model.html">
 <span class="dropdown-text">Environmental Effects on Occupancy</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-supplemental" role="button" data-bs-toggle="dropdown" aria-expanded="false">Supplemental</a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-supplemental">    
        <li>
    <a class="dropdown-item" href="./supp_01_ctd-by-cruise.html">
 <span class="dropdown-text">CTD by Cruise</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./supp_02_pc-extended-info.html">
 <span class="dropdown-text">Extended PCA/Clustering Plots</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./supp_03_cluster-conc.html">
 <span class="dropdown-text">Integrated Abundancy by Morphogroup</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./supp_04_all-copepod-occurrence.html">
 <span class="dropdown-text">All Copepod Occupancy</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/TheAlexBarth/DMV_BATS"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://thealexbarth.github.io/#about"><i class="bi bi-house-fill" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Morphogroup Occupancy Model</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="methodology" class="level1">
<h1>Methodology:</h1>
<p>The full rationale and background on site-occupancy modelling can be found <a href="./main_05_all-copepod-occupancy.html">here</a>. Following the verification of the technique, we applied these models to determine water column occupancy for each of the different morphogroups. This model followed the same structure as the all-copepod model, where occupancy (<span class="math inline">\(\psi\)</span>) was assumed to be a unique, independent probability for each depth-bin and each morphogroup. As such this is a simple extension of the previous model, just ran for each individual morphogroup at site <span class="math inline">\(i\)</span>, in depth-bin <span class="math inline">\(db\)</span>, at each time of day <span class="math inline">\(tod\)</span>. Again these models were ran separately for the epipelagic, upper mesopelagic, and low mesopelagic.</p>
<p><span class="math display">\[
Y_{ij,db,tod,mg} \sim Bernoilli(p_{ij,tod,mg}*z_{i,db,tod,mg})
\]</span></p>
<p><span class="math display">\[
z_{i,db,tod,mg} \sim Binomial(\psi_{db,tod,mg})
\]</span></p>
<p><span class="math display">\[
logit(p_{ij,tod,mg}) \sim a_0 + a_{vs,tod,mg} * vs_{ij}
\]</span></p>
<p>The same priors were used in this model as described previously. All model conditions and MCMC simulation methods were consistent as well.</p>
</section>
<section id="key-figures-and-takeaways" class="level1">
<h1>Key Figures and Takeaways:</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wiqid)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(EcotaxaTools)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">'../R/tools.R'</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>db <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">'../data/05_db-list.rds'</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>epi_mod_output <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">'../data/05_cluster-occ-mod-epi.rds'</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>tmeso_mod_output <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">'../data/05_cluster-occ-mod-tmeso.rds'</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>bmeso_mod_output <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">'../data/05_cluster-occ-mod-bmeso.rds'</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># |- Extact credible intervals from models -------------</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>psi_extract <span class="ot">&lt;-</span> <span class="cf">function</span>(model, tod, min_d, max_d, <span class="at">db =</span> db) {</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  db_length <span class="ot">&lt;-</span> <span class="fu">ncol</span>(model[[tod]]<span class="sc">$</span>sims.list<span class="sc">$</span>psi)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  out_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">db =</span> <span class="fu">db_decode</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>db_length), tod, min_d, max_d, <span class="at">db =</span> db),</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, db_length),</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">low =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, db_length),</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">high =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, db_length)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>db_length) {</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    out_df[i,<span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(model[[tod]]<span class="sc">$</span>sims.list<span class="sc">$</span>psi[,i]),</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">hdi</span>(model[[tod]]<span class="sc">$</span>sims.list<span class="sc">$</span>psi[,i]))</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out_df)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>occ_pred <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">'list'</span>, <span class="dv">4</span>)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(tod <span class="cf">in</span> <span class="fu">c</span>(<span class="st">'day'</span>, <span class="st">'night'</span>)) {</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    occ_pred[[i]][[tod]] <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind,<span class="fu">list</span>(</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>      <span class="fu">psi_extract</span>(epi_mod_output[[i]],</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>                  tod, <span class="dv">0</span>, <span class="dv">200</span>,</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>                  <span class="at">db =</span> db[[i]]),</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">psi_extract</span>(tmeso_mod_output[[i]],</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>                  tod, <span class="dv">200</span>, <span class="dv">600</span>,</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>                  <span class="at">db =</span> db[[i]]),</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>      <span class="fu">psi_extract</span>(bmeso_mod_output[[i]],</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>                  tod, <span class="dv">600</span>, <span class="dv">1200</span>,</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>                  <span class="at">db =</span> db[[i]]))) <span class="sc">|&gt;</span> </span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bin_format</span>()</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(occ_pred) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>occ_pred <span class="ot">&lt;-</span> occ_pred <span class="sc">|&gt;</span> </span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(list_to_tib, <span class="st">'tod'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list_to_tib</span>(<span class="st">'cluster'</span>)</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting ######</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>ribbon_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(cluster) {</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>  plot_data <span class="ot">&lt;-</span> occ_pred[occ_pred<span class="sc">$</span>cluster <span class="sc">==</span> cluster,]</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>  out_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data) <span class="sc">+</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> mp,</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y =</span> mean,</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ymin =</span> low,</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ymax =</span> high,</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fill =</span> tod,</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color =</span> tod),</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>                <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> mp,</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> mean,</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> tod),</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> .<span class="dv">75</span>) <span class="sc">+</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>tod)<span class="sc">+</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_reverse</span>() <span class="sc">+</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(dn_cols[<span class="st">'day'</span>],dn_cols[<span class="st">'night'</span>])) <span class="sc">+</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(dn_cols[<span class="st">'day'</span>],dn_cols[<span class="st">'night'</span>])) <span class="sc">+</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_pubr</span>() <span class="sc">+</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Depth [m]'</span>, <span class="at">y =</span> <span class="st">"Occupancy"</span>) <span class="sc">+</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>,</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>))</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out_plot)</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a><span class="co"># point_plot &lt;- function(cluster) {</span></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot_data &lt;- occ_pred[occ_pred$cluster == cluster,]</span></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a><span class="co">#   out_plot &lt;- ggplot(plot_data) +</span></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_pointrange(aes(x = mp,</span></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a><span class="co">#                         y = mean,</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a><span class="co">#                         ymin = low,</span></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a><span class="co">#                         ymax = high,</span></span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a><span class="co">#                         color = tod),</span></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a><span class="co">#                     position = position_dodge(width = 5)) +</span></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_x_reverse() +</span></span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_fill_manual(values = c(dn_cols['day'],dn_cols['night'])) +</span></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_color_manual(values = c(dn_cols['day'],dn_cols['night'])) +</span></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a><span class="co">#     coord_flip()+</span></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a><span class="co">#     theme_pubr() +</span></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a><span class="co">#     labs(x = 'Depth [m]', y = "Occupancy") +</span></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a><span class="co">#     theme(legend.position = 'none')</span></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a><span class="co">#   return(out_plot)</span></span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>ribbon_occupancy <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">'list'</span>,<span class="dv">4</span>)</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a><span class="co"># point_occupancy &lt;- vector('list', 4)</span></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>  ribbon_occupancy[[i]] <span class="ot">&lt;-</span> <span class="fu">ribbon_plot</span>(i)</span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>  <span class="co"># point_occupancy[[i]] &lt;- point_plot(i)</span></span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page-outset</span></span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(ribbon_occupancy[[<span class="dv">1</span>]],</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>          ribbon_occupancy[[<span class="dv">2</span>]] <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>()),</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>          ribbon_occupancy[[<span class="dv">3</span>]] <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>()),</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>          ribbon_occupancy[[<span class="dv">4</span>]] <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>()),</span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="main_06_cluster-occurence_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="960"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggarrange(point_occupancy[[1]],</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#           point_occupancy[[2]] + theme(axis.title.y = element_blank()),</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#           point_occupancy[[3]] + theme(axis.title.y = element_blank()),</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#           point_occupancy[[4]] + theme(axis.title.y = element_blank()),</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#           ncol = 4)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Generally, across all morphogroups, it can be seen that the credible intervals (95% high density interval of the posterior distribution) for copepod occupancy are very wide. Often ranging from 25% to 100%. However, there are some clear trends consistent with DVM hypotheses. Notably, there is an increased nighttime occupancy for all morphogroups from the 40m to 140m. For depth bins in those regions, the mean posterior occupancy ranged from 71% to 88%, indicating there is a high likelihood all morphogroups will be found in that region at night. There is lower daytime occupancy over that same region, however this varies by morphogroup. Notably, morphogroup 4 has a 54% mean posterior daytime occupancy from 40m-140m. This indicates a decreased likely of the larger morphogroup 4 copepods in that area during daytime. All other morphogroups have higher posterior daytime occupancy rates in the epipelagic. Generally throughout the rest of the water column, the posterior estimates of occupancy are consistent, except for a decline around 225-300m which is consistent with the abundance profiles. Overall, morphogroup 4 had a wider credible interval around the posterior occupancy estimate which is likely due to it’s rarity.</p>
<p>A possilbe reason for the wide range of occupancy variables is the fact we have yet to account for environmental influences on occupancy across different cruises (sites). This is investigated in <a href="./main_07_environmental-effect-model.html">Figure 7</a></p>
<p>The full occupancy credible intervals for each morphotype and depthbin can be seen below:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>occ_pred <span class="sc">|&gt;</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">DepthBin =</span> db, <span class="at">BinMidPoint =</span> mp,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">lowerCI =</span> low, <span class="at">meanPsi =</span> mean, <span class="at">upperCI =</span> high, <span class="at">TimeOfDay =</span> tod, </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">MorphoGroup =</span> cluster) <span class="sc">|&gt;</span> </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>(<span class="at">filter =</span> <span class="st">'top'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-7dc9889a25b9ab484a95" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-7dc9889a25b9ab484a95">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"10\" data-max=\"1190\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"3.81036088e-07\" data-max=\"0.81413307823905\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.134448236342711\" data-max=\"0.933987388340229\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.302261550552681\" data-max=\"0.999999956437351\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480"],["(0,20]","(100,120]","(120,140]","(140,160]","(160,180]","(180,200]","(20,40]","(40,60]","(60,80]","(80,100]","(200,220]","(220,240]","(240,260]","(260,280]","(280,300]","(300,320]","(320,340]","(340,360]","(360,380]","(380,400]","(400,420]","(420,440]","(440,460]","(460,480]","(480,500]","(500,520]","(520,540]","(540,560]","(560,580]","(580,600]","(1.02e+03,1.04e+03]","(1.04e+03,1.06e+03]","(1.06e+03,1.08e+03]","(1.08e+03,1.1e+03]","(1.12e+03,1.14e+03]","(1.14e+03,1.16e+03]","(1.16e+03,1.18e+03]","(1.18e+03,1.2e+03]","(1.1e+03,1.12e+03]","(1e+03,1.02e+03]","(600,620]","(620,640]","(640,660]","(660,680]","(680,700]","(700,720]","(720,740]","(740,760]","(760,780]","(780,800]","(800,820]","(820,840]","(840,860]","(860,880]","(880,900]","(900,920]","(920,940]","(940,960]","(960,980]","(980,1e+03]","(0,20]","(100,120]","(120,140]","(140,160]","(160,180]","(180,200]","(20,40]","(40,60]","(60,80]","(80,100]","(200,220]","(220,240]","(240,260]","(260,280]","(280,300]","(300,320]","(320,340]","(340,360]","(360,380]","(380,400]","(400,420]","(420,440]","(440,460]","(460,480]","(480,500]","(500,520]","(520,540]","(540,560]","(560,580]","(580,600]","(1.02e+03,1.04e+03]","(1.04e+03,1.06e+03]","(1.06e+03,1.08e+03]","(1.08e+03,1.1e+03]","(1.12e+03,1.14e+03]","(1.14e+03,1.16e+03]","(1.16e+03,1.18e+03]","(1.18e+03,1.2e+03]","(1.1e+03,1.12e+03]","(1e+03,1.02e+03]","(600,620]","(620,640]","(640,660]","(660,680]","(680,700]","(700,720]","(720,740]","(740,760]","(760,780]","(780,800]","(800,820]","(820,840]","(840,860]","(860,880]","(880,900]","(900,920]","(920,940]","(940,960]","(960,980]","(980,1e+03]","(0,20]","(100,120]","(120,140]","(140,160]","(160,180]","(180,200]","(20,40]","(40,60]","(60,80]","(80,100]","(200,220]","(220,240]","(240,260]","(260,280]","(280,300]","(300,320]","(320,340]","(340,360]","(360,380]","(380,400]","(400,420]","(420,440]","(440,460]","(460,480]","(480,500]","(500,520]","(520,540]","(540,560]","(560,580]","(580,600]","(1.02e+03,1.04e+03]","(1.04e+03,1.06e+03]","(1.06e+03,1.08e+03]","(1.08e+03,1.1e+03]","(1.12e+03,1.14e+03]","(1.14e+03,1.16e+03]","(1.16e+03,1.18e+03]","(1.18e+03,1.2e+03]","(1.1e+03,1.12e+03]","(1e+03,1.02e+03]","(600,620]","(620,640]","(640,660]","(660,680]","(680,700]","(700,720]","(720,740]","(740,760]","(760,780]","(780,800]","(800,820]","(820,840]","(840,860]","(860,880]","(880,900]","(900,920]","(920,940]","(940,960]","(960,980]","(980,1e+03]","(0,20]","(100,120]","(120,140]","(140,160]","(160,180]","(180,200]","(20,40]","(40,60]","(60,80]","(80,100]","(200,220]","(220,240]","(240,260]","(260,280]","(280,300]","(300,320]","(320,340]","(340,360]","(360,380]","(380,400]","(400,420]","(420,440]","(440,460]","(460,480]","(480,500]","(500,520]","(520,540]","(540,560]","(560,580]","(580,600]","(1.02e+03,1.04e+03]","(1.04e+03,1.06e+03]","(1.06e+03,1.08e+03]","(1.08e+03,1.1e+03]","(1.12e+03,1.14e+03]","(1.14e+03,1.16e+03]","(1.16e+03,1.18e+03]","(1.18e+03,1.2e+03]","(1.1e+03,1.12e+03]","(1e+03,1.02e+03]","(600,620]","(620,640]","(640,660]","(660,680]","(680,700]","(700,720]","(720,740]","(740,760]","(760,780]","(780,800]","(800,820]","(820,840]","(840,860]","(860,880]","(880,900]","(900,920]","(920,940]","(940,960]","(960,980]","(980,1e+03]","(0,20]","(100,120]","(120,140]","(140,160]","(160,180]","(180,200]","(20,40]","(40,60]","(60,80]","(80,100]","(200,220]","(220,240]","(240,260]","(260,280]","(280,300]","(300,320]","(320,340]","(340,360]","(360,380]","(380,400]","(400,420]","(420,440]","(440,460]","(460,480]","(480,500]","(500,520]","(520,540]","(540,560]","(560,580]","(580,600]","(1.02e+03,1.04e+03]","(1.04e+03,1.06e+03]","(1.06e+03,1.08e+03]","(1.08e+03,1.1e+03]","(1.12e+03,1.14e+03]","(1.14e+03,1.16e+03]","(1.16e+03,1.18e+03]","(1.18e+03,1.2e+03]","(1.1e+03,1.12e+03]","(1e+03,1.02e+03]","(600,620]","(620,640]","(640,660]","(660,680]","(680,700]","(700,720]","(720,740]","(740,760]","(760,780]","(780,800]","(800,820]","(820,840]","(840,860]","(860,880]","(880,900]","(900,920]","(920,940]","(940,960]","(960,980]","(980,1e+03]","(0,20]","(100,120]","(120,140]","(140,160]","(160,180]","(180,200]","(20,40]","(40,60]","(60,80]","(80,100]","(200,220]","(220,240]","(240,260]","(260,280]","(280,300]","(300,320]","(320,340]","(340,360]","(360,380]","(380,400]","(400,420]","(420,440]","(440,460]","(460,480]","(480,500]","(500,520]","(520,540]","(540,560]","(560,580]","(580,600]","(1.02e+03,1.04e+03]","(1.04e+03,1.06e+03]","(1.06e+03,1.08e+03]","(1.08e+03,1.1e+03]","(1.12e+03,1.14e+03]","(1.14e+03,1.16e+03]","(1.16e+03,1.18e+03]","(1.18e+03,1.2e+03]","(1.1e+03,1.12e+03]","(1e+03,1.02e+03]","(600,620]","(620,640]","(640,660]","(660,680]","(680,700]","(700,720]","(720,740]","(740,760]","(760,780]","(780,800]","(800,820]","(820,840]","(840,860]","(860,880]","(880,900]","(900,920]","(920,940]","(940,960]","(960,980]","(980,1e+03]","(0,20]","(100,120]","(120,140]","(140,160]","(160,180]","(180,200]","(20,40]","(40,60]","(60,80]","(80,100]","(200,220]","(220,240]","(240,260]","(260,280]","(280,300]","(300,320]","(320,340]","(340,360]","(360,380]","(380,400]","(400,420]","(420,440]","(440,460]","(460,480]","(480,500]","(500,520]","(520,540]","(540,560]","(560,580]","(580,600]","(1.02e+03,1.04e+03]","(1.04e+03,1.06e+03]","(1.06e+03,1.08e+03]","(1.08e+03,1.1e+03]","(1.12e+03,1.14e+03]","(1.14e+03,1.16e+03]","(1.16e+03,1.18e+03]","(1.18e+03,1.2e+03]","(1.1e+03,1.12e+03]","(1e+03,1.02e+03]","(600,620]","(620,640]","(640,660]","(660,680]","(680,700]","(700,720]","(720,740]","(740,760]","(760,780]","(780,800]","(800,820]","(820,840]","(840,860]","(860,880]","(880,900]","(900,920]","(920,940]","(940,960]","(960,980]","(980,1e+03]","(0,20]","(100,120]","(120,140]","(140,160]","(160,180]","(180,200]","(20,40]","(40,60]","(60,80]","(80,100]","(200,220]","(220,240]","(240,260]","(260,280]","(280,300]","(300,320]","(320,340]","(340,360]","(360,380]","(380,400]","(400,420]","(420,440]","(440,460]","(460,480]","(480,500]","(500,520]","(520,540]","(540,560]","(560,580]","(580,600]","(1.02e+03,1.04e+03]","(1.04e+03,1.06e+03]","(1.06e+03,1.08e+03]","(1.08e+03,1.1e+03]","(1.12e+03,1.14e+03]","(1.14e+03,1.16e+03]","(1.16e+03,1.18e+03]","(1.18e+03,1.2e+03]","(1.1e+03,1.12e+03]","(1e+03,1.02e+03]","(600,620]","(620,640]","(640,660]","(660,680]","(680,700]","(700,720]","(720,740]","(740,760]","(760,780]","(780,800]","(800,820]","(820,840]","(840,860]","(860,880]","(880,900]","(900,920]","(920,940]","(940,960]","(960,980]","(980,1e+03]"],[10,110,130,150,170,190,30,50,70,90,210,230,250,270,290,310,330,350,370,390,410,430,450,470,490,510,530,550,570,590,1030,1050,1070,1090,1130,1150,1170,1190,1110,1010,610,630,650,670,690,710,730,750,770,790,810,830,850,870,890,910,930,950,970,990,10,110,130,150,170,190,30,50,70,90,210,230,250,270,290,310,330,350,370,390,410,430,450,470,490,510,530,550,570,590,1030,1050,1070,1090,1130,1150,1170,1190,1110,1010,610,630,650,670,690,710,730,750,770,790,810,830,850,870,890,910,930,950,970,990,10,110,130,150,170,190,30,50,70,90,210,230,250,270,290,310,330,350,370,390,410,430,450,470,490,510,530,550,570,590,1030,1050,1070,1090,1130,1150,1170,1190,1110,1010,610,630,650,670,690,710,730,750,770,790,810,830,850,870,890,910,930,950,970,990,10,110,130,150,170,190,30,50,70,90,210,230,250,270,290,310,330,350,370,390,410,430,450,470,490,510,530,550,570,590,1030,1050,1070,1090,1130,1150,1170,1190,1110,1010,610,630,650,670,690,710,730,750,770,790,810,830,850,870,890,910,930,950,970,990,10,110,130,150,170,190,30,50,70,90,210,230,250,270,290,310,330,350,370,390,410,430,450,470,490,510,530,550,570,590,1030,1050,1070,1090,1130,1150,1170,1190,1110,1010,610,630,650,670,690,710,730,750,770,790,810,830,850,870,890,910,930,950,970,990,10,110,130,150,170,190,30,50,70,90,210,230,250,270,290,310,330,350,370,390,410,430,450,470,490,510,530,550,570,590,1030,1050,1070,1090,1130,1150,1170,1190,1110,1010,610,630,650,670,690,710,730,750,770,790,810,830,850,870,890,910,930,950,970,990,10,110,130,150,170,190,30,50,70,90,210,230,250,270,290,310,330,350,370,390,410,430,450,470,490,510,530,550,570,590,1030,1050,1070,1090,1130,1150,1170,1190,1110,1010,610,630,650,670,690,710,730,750,770,790,810,830,850,870,890,910,930,950,970,990,10,110,130,150,170,190,30,50,70,90,210,230,250,270,290,310,330,350,370,390,410,430,450,470,490,510,530,550,570,590,1030,1050,1070,1090,1130,1150,1170,1190,1110,1010,610,630,650,670,690,710,730,750,770,790,810,830,850,870,890,910,930,950,970,990],[0.221217659084122,0.306598200695898,0.1596385552109,0.289937444654545,0.0641451077368011,0.410439465496179,0.340922489988794,0.344598977006302,0.453403934409421,0.593638236835203,0.0586647439867313,0.544656134696694,0.383486135325268,0.0687860393026999,0.473391779385677,0.292666001739028,0.0144120505586493,0.197080953616524,0.0539660834687694,0.148148109227388,0.0702579778620485,0.0556858242708398,0.438571739338398,0.187488709524561,0.474487300697673,0.483325281889837,0.500189215328625,0.580572364495173,0.488290491525503,0.668887263056977,0.162934265304045,0.161799407619353,0.269608449827743,0.198526233834699,0.318198920591534,0.162780138886323,0.519722624179652,0.4013923255385,0.552915595828782,0.06839268069373,0.519707322712532,0.37724200428997,0.383208115771191,0.277288327416506,0.446459789021815,0.131661502078655,0.269628517868461,0.253561839144557,0.61412182600982,0.45833200315455,0.485269976376779,0.465368293247779,0.614770929069895,0.284213987558747,0.702638366758657,0.382832540001147,0.390027453663303,0.398081747716846,0.374853602819918,0.286750464091608,0.35261763940196,0.576174227338986,0.650483631016981,0.225348398749736,0.402295749064022,0.0750107768452587,0.42970113379142,0.526161584858999,0.607272859126313,0.612215868348144,0.60935983136113,0.395154125235771,0.192429619010139,6.97203590652762e-06,2.27247302896084e-05,2.90499366469013e-05,0.314348213022542,0.198562066024654,0.200973915122481,0.0280303143279012,1.65695784396465e-05,1.00554781169725e-05,0.0261587517217406,0.194896262097383,0.173513786614893,0.0392410230822905,1.01663971810877e-06,0.213995160578702,0.0507557921640049,0.508041132178896,0.428515348650646,0.407205909828147,0.322084097526174,0.205165070525287,0.505197558454327,0.00966959436164821,0.0879139112398391,0.0104809251324855,0.204793670643926,0.0667508005929309,0.203636230286233,0.0107800227620969,0.497418096703418,0.485328929672205,0.42509563921502,0.199032164022062,0.578050983172773,0.370981317223405,0.316148208953418,0.220349302820154,0.441670568132918,0.529054900890727,0.574314623081286,0.213421600964173,0.303754986715487,0.0736344086169538,0.408944667874599,0.427526056063245,0.349473809783295,0.19751084793206,0.647231044589773,0.642235168024795,0.725922101616563,0.318821372188561,0.358982565446948,0.384544031475775,0.750838989249355,0.693412652973107,0.694086296581809,0.768544817326543,0.192235289446634,0.602338692111932,0.431075119169738,0.218640088313637,0.133380586159738,0.136046549982097,0.321037097666737,0.0328418311004486,0.407295965346816,0.0912325918838612,0.480273180043662,0.394242813190232,0.665072476455774,0.337237958001446,0.800846165854405,0.757266304177039,0.494370628316654,0.668400169681289,0.753822945476908,0.394049675262595,0.277068468103961,0.161336865729394,0.516927386502615,0.615057697365298,0.293777930012444,0.418833617732399,0.2120075827316,0.581281919547257,0.216023532587818,0.217539353589313,0.606469584796506,0.226204204999464,0.194466902270018,0.559557756033838,0.360056435880585,0.476732681048439,0.471488522980865,0.5868083011595,0.528555230060034,0.744184088038367,0.718755693788605,0.58657624919816,0.55754880045989,0.472186981891285,0.193829186947489,0.336013319862007,0.275786061274651,0.470603155553111,0.209999052259304,0.342797239954784,0.614472289163497,0.708989852528412,0.440957271458274,0.527585434916414,0.381887812630428,0.0966718189221328,0.68912387497967,0.784976731364356,0.81413307823905,0.766482008262023,0.632586249967086,0.00688701363510725,0.220126254875068,0.237319150629459,0.433019930346501,0.44729564599096,0.339291616925922,0.335862544697917,0.115437956606424,0.0178584969562822,0.104501680416985,0.333263220457345,0.248775296244109,0.0114943960448373,0.330241885658116,0.122740503037741,0.143702494710119,0.29104307951461,0.364159313214224,0.379488204546393,0.187346364209398,0.112159353854847,0.320806790892626,0.420076229076354,0.12369392119895,0.427007790024235,0.252927018902579,0.405500368295684,0.432880201044967,0.305909978703963,0.5247359194241,0.552635532569297,0.420780034337862,0.498629454160173,0.404245469165148,0.0510952403307395,0.398444290486856,0.596707351795196,0.479548504053904,0.612457351090773,0.567786981878766,0.508683098819771,0.407625049351331,0.43039964873423,0.506337663233631,0.176601872236301,0.11101928295222,0.204267758072641,0.459416372361087,0.339829296740635,0.55794682654337,0.566877225134193,0.512036105313598,0.464436431649083,0.129275211274825,0.307773061119752,0.454235351718608,0.588403971877169,0.633936800117687,0.498452958672002,0.130654827829063,0.123400267665817,0.275044972103426,0.276061704786898,0.27297203884136,0.253058185292187,0.325476129582745,0.350194796382782,0.451006280642263,0.265107142495636,0.611496783547182,0.552382135746384,0.542443184230925,0.256375603671387,0.565597357158836,0.593548970805115,0.66850117833963,0.650603839315718,0.67258652067268,0.693173053487395,0.445057017027116,0.24449826998052,0.214873314139902,0.563271680784815,0.437106285114991,0.542525389481466,0.47821820662376,0.27706668285636,0.584988395851684,0.225123958804536,0.46357967218091,0.530757346087545,0.277349549761619,0.680016398570577,0.519951377076807,0.350580832271977,0.691265823575228,0.597065109062066,0.658227991740163,0.479922959748288,0.614435667516519,0.486951709785275,0.598513095916789,0.0852113693435399,0.740392872608027,0.589638541648335,0.492365783812254,0.51765738450184,0.60556011395699,0.49444458570194,0.734386921368334,0.745069157893941,0.521439573674004,0.268112100282269,0.194854301260485,0.00278491904501214,0.717068750115093,0.748344581514788,0.786036466775179,0.788649094155564,0.401841061465848,0.244948508611251,0.253545772143304,0.255883050016938,0.112348803984771,0.0109228883235848,0.0169659499186314,0.0159516945762926,0.126273001209265,0.35314715969432,0.128856794578237,0.259833170196808,2.31030716986462e-05,0.242568546325616,0.0955074854351852,0.2797613321833,0.0246260575144296,0.573822924497906,0.560233712692246,0.278362063950247,0.437831992434405,0.508120171971332,0.511908631758439,0.238900962617279,0.39300181012995,0.178321664875943,0.111960635994775,0.507446057600144,0.671112602379454,0.179036690411053,0.509345039779252,0.118443159252575,0.324667038594101,0.373519963400187,0.421969927348687,0.433954272053599,0.422131591774464,0.447496321171722,0.342583135364486,0.537122095746493,0.685618535632121,0.48176726628636,0.516372975655734,0.425592084988319,0.589249547000402,0.399931690549304,0.418400318661339,0.681462120448808,0.429738397075886,0.489509100219853,0.227458336943022,0.224590294013893,1.48568770793416e-06,1.84562009767468e-06,0.0944880081033479,0.061168552359327,0.0594468309972924,1.00864215064981e-05,0.512649135531424,0.324615497539357,0.0301356190211017,0.185457319857049,2.30747346464133e-05,3.48112984515774e-06,2.10694296728762e-05,6.21501861973783e-06,1.4450118131918e-05,0.0373492602788091,0.194303678437432,0.0505218567320749,0.0380832831888621,0.0384495526043333,1.64646683506614e-06,0.478369544906088,0.190225971197441,2.28515464709824e-05,0.0515139534202647,0.431523901937775,0.328494881723379,0.573201112964397,0.291123049672896,0.131969129943993,0.0279354763206182,0.165773003449173,0.0180384298586311,0.137862966394486,0.361095069265494,0.181998756482406,0.272290652445152,0.173588031694847,0.359189035668049,0.0215946635978748,0.141782252532453,0.374076361365538,0.117639586624737,0.509897416365421,0.380086451941322,0.132676766618188,0.429650193258305,0.272352807235453,0.543323169710879,0.347742228642213,0.275902163371606,0.270222777785588,0.466463759154561,0.274685961390353,1.41932191124058e-05,0.412938576743692,0.0218010800230779,0.400219599909839,0.00871584988849068,0.546224929026139,0.547959884449452,0.165815636533184,0.129548311883487,0.0562136198776517,0.0080239182272966,0.25043099392959,0.323221697253867,0.352665579376815,0.234444773745277,5.59534451234961e-05,0.291259457563012,1.47307003984752e-05,0.155960705499574,0.154871790191531,2.1523627144371e-05,2.08474004050468e-05,0.298242855573188,0.147721709339884,6.95277869475334e-05,3.02145826362607e-05,0.154785359401,1.40261946286572e-06,0.28420537728188,0.00010118746695327,1.74683896089535e-05,0.156798575210886,7.48704099411062e-06,0.154420081570156,0.0448258189276558,0.208730773756166,0.326519876395188,0.196946008134962,0.309782460867453,0.323232610545399,0.406224560462114,0.0343954857249121,0.208694599922127,0.193357890223088,3.81036088836853e-07,0.212578965589162,0.159541661053714,0.178313184131855,0.0362354376018955,0.204274119426331,0.198780284301781,0.0309976771785714,0.573128932667406,0.2120953706668,0.0342830867531888,0.199203490067913,0.3186384248302,0.310352037302388,0.424787994953821,0.300674378329742,0.423859907546844,0.0388271020613217,0.313037579592521,1.06707108076007e-06],[0.566682604829322,0.650424282254398,0.529986940914544,0.627480854910016,0.423793818508198,0.734535320487138,0.686398130533053,0.665868914013029,0.758876552820271,0.84017262795896,0.377147808988118,0.813916650237395,0.707060963898895,0.427804153250801,0.773314571454434,0.623203512956652,0.284210915644241,0.551404169737593,0.425790513855816,0.520077459141257,0.418287784316785,0.42305272911565,0.74618763133075,0.541964999705936,0.774028743859752,0.782132135032639,0.790423321254461,0.839966160545013,0.782755526047783,0.878550344407871,0.544551369832917,0.529739685359551,0.597881199698097,0.551233455357996,0.648073261188969,0.522980460813213,0.798078073972104,0.727594527748581,0.818346860046754,0.420208736710139,0.799167572539558,0.696799903652164,0.69967708086157,0.607404201201696,0.748921434085528,0.508241495044768,0.60192365068185,0.582410682254501,0.851804378245183,0.761566161519965,0.780259416115155,0.763659223481087,0.849757269204141,0.612584891013968,0.892331394680846,0.70933085397318,0.710986293947496,0.716741374054073,0.689742992408474,0.615726568920022,0.643243947221511,0.815557675667804,0.860806855574717,0.52806160320705,0.678175197163715,0.339910933848538,0.705652984252017,0.794392188092564,0.837822515635641,0.841425650047645,0.850082610770706,0.738621621315127,0.565511529311864,0.237678613225444,0.237108865171741,0.229480697663639,0.689866330918049,0.578516316978061,0.58707609616186,0.426610292801293,0.235472254894369,0.22522216063254,0.424505239584096,0.579125277405441,0.547814677747722,0.439813412861976,0.264972330789592,0.604568892145655,0.470721077699003,0.805189176100529,0.739627858794026,0.726358987496316,0.658038050015185,0.56499159339031,0.794496458609839,0.306817112412843,0.452014847924922,0.313284875851784,0.570214124134782,0.431379517157937,0.555488034238563,0.294962367052847,0.790851065116492,0.781753807374832,0.745572008688582,0.562216717609686,0.837528661372047,0.690438019125297,0.650372155805366,0.567445855678347,0.748539841754707,0.807157077464223,0.833116646877757,0.572836635937334,0.633884142077947,0.447686707041374,0.730574140510114,0.747467228583213,0.693727863732344,0.557653328116655,0.842746742956171,0.849017846593373,0.896864500643054,0.575486400744166,0.62288550476202,0.64221195380451,0.907849997530063,0.869462300774301,0.866045845521862,0.914947695690804,0.483358261935798,0.833043892073,0.713860180711478,0.529637748287283,0.436970462429449,0.429014935975092,0.639620407022593,0.273837466422622,0.690564131552238,0.366679273206622,0.750374376509489,0.680451450075608,0.86457534961828,0.636917119373655,0.931075524228116,0.912139955971793,0.780436361176325,0.875789204088189,0.912303169893066,0.697467075870398,0.583302838783728,0.447642013686083,0.762596899625821,0.842554519398898,0.603161195379582,0.695855877719421,0.528192392195527,0.826036979814529,0.529919672432849,0.537338444596519,0.837826197264436,0.541967527185571,0.509612650317327,0.809635657207754,0.653721827087603,0.745737786882834,0.735527354849116,0.821276504921314,0.780183828622314,0.905903270901424,0.891038620574189,0.82013416033536,0.792562537056929,0.733988699359295,0.491187095831394,0.625365016223557,0.58657590023198,0.739764550166616,0.52509231607106,0.642526214147889,0.826076076940002,0.873300323530064,0.685572343822952,0.759019317464796,0.632962551228877,0.306634499400959,0.879425549127756,0.924026662969489,0.933987388340229,0.913581189035921,0.858337548352252,0.308109358290917,0.58250900155326,0.592209426075488,0.751226770696117,0.763176180037253,0.684485195907264,0.681813300377829,0.483625462504803,0.326680433777973,0.48239475567254,0.678843591467772,0.601298796365128,0.307915418690761,0.673688353435633,0.51485193531243,0.53535343466278,0.656556385757969,0.710696323375508,0.72803030844127,0.540153507548816,0.454296205501769,0.634186735576131,0.718344685618441,0.465681283365977,0.734058801188973,0.587313777131703,0.704435323592571,0.736258257213286,0.621268471827967,0.801965429272679,0.813053418682002,0.724813387905844,0.780170965709518,0.704274797744493,0.332783841572763,0.695800118863509,0.835835291168526,0.766341209543257,0.846297719410755,0.819366834640495,0.7899889611877,0.704696350292755,0.730821842467437,0.785048747779131,0.512617155417492,0.429975462971447,0.54539547300787,0.759530922786382,0.654192880420381,0.794233411931733,0.805583988614381,0.764482972434006,0.730887599734347,0.39300541215971,0.607732656345517,0.715702694513191,0.824055744834546,0.851828047106038,0.754167494126586,0.395081609180392,0.396901157179005,0.585197331965306,0.581619670064607,0.579088405956194,0.548715039245249,0.629918105539168,0.642239775620707,0.723065635467683,0.572583333333618,0.841155307710818,0.79220483723356,0.799102987061345,0.55471942351982,0.80501953964941,0.829448071068236,0.875073091608689,0.862977824128299,0.875763421497299,0.885779580046295,0.719446638625544,0.57117843999199,0.533698390345974,0.810219222200091,0.713216353427633,0.806175987326662,0.742124818494608,0.580058318464962,0.826155841684038,0.543343419285057,0.728611411508268,0.781912494254942,0.586862351113647,0.873777295668606,0.770229613734254,0.650503883304304,0.881365574858392,0.82576469077562,0.864833275347867,0.751594779794755,0.839542075050045,0.751284488943702,0.828309999798847,0.352122153122709,0.905910704722233,0.827771833222335,0.759230397286203,0.785454108121717,0.83477538394196,0.761327036828696,0.902384526535222,0.904537253188234,0.75168770246504,0.530714577699908,0.43317994255956,0.134448236342711,0.893642776659718,0.908965575160704,0.923261003072994,0.924874276019729,0.731127568196846,0.596360453697566,0.609524398391705,0.611365038171219,0.502028602084718,0.364362258655548,0.359394237621327,0.354297620961611,0.495566057802388,0.703366445706429,0.505693093328968,0.621846539522532,0.177400532636686,0.59248262143845,0.489195367202417,0.64407460287426,0.393074625037125,0.836330473981228,0.828688138132144,0.643283820716633,0.738161945295363,0.78999217761574,0.78531988466284,0.581472536928254,0.689274595198037,0.517944291105754,0.447017803362847,0.784545761037129,0.876564580769693,0.52315675361604,0.783679336927183,0.449844182144389,0.633614964074034,0.670215409213158,0.724316308707013,0.716183406208768,0.720988114900702,0.732764706983862,0.652702831267562,0.796841514657497,0.88325326921242,0.765738845327196,0.794859490777385,0.720383727223712,0.835702328541495,0.69815889722641,0.720579295880265,0.881679927968242,0.727638656242875,0.774120180405695,0.625236974585513,0.621835459403399,0.269141983263898,0.271635561664974,0.487086188204263,0.480891192488902,0.482170976498092,0.279266146237453,0.812311945321381,0.696513418683916,0.409080320298844,0.56338195189519,0.245942352406399,0.235711557473583,0.235132672930419,0.231892765528947,0.244857214091366,0.4395668090503,0.57575877625975,0.450106724087841,0.440652643443755,0.425278872712807,0.24217590370056,0.792187904558842,0.569053024668668,0.241327021581428,0.4551574792343,0.761612677440479,0.698708321603477,0.838435920417064,0.660534714144267,0.517154296091591,0.392577327892922,0.531779708512217,0.381546680181809,0.525782085953604,0.708793803629255,0.553962327766292,0.637888303563683,0.551092047853153,0.701243989089401,0.359020263805727,0.521760743515859,0.717899815857423,0.503335777435167,0.798422757780857,0.723030931948349,0.50878929473133,0.755101075418277,0.634695459986743,0.81958171574765,0.695624549253282,0.64148433390282,0.631704450855707,0.78058687099155,0.640142845016671,0.197666333138911,0.748771473157066,0.392004581440611,0.739755841207492,0.300818667322849,0.815419497749022,0.818602794366498,0.526073357509808,0.478977991914457,0.366219298948713,0.277993412342594,0.589536460564912,0.639000095606027,0.66900040570739,0.643368601319185,0.364293257327578,0.692338822483137,0.383999025909215,0.580077071067018,0.57684733175634,0.38711506242808,0.381354343583638,0.696526445221491,0.57221617080082,0.368522073941143,0.362180697927712,0.573129784022094,0.360437996007257,0.685512319639576,0.378024074607696,0.390858779551022,0.5853981750018,0.389067978920054,0.576229368533636,0.446092361806225,0.598080329147619,0.690507727421405,0.581247278000496,0.681476401303164,0.693796776726153,0.74441899823936,0.442275385757438,0.592250606576078,0.569630288099731,0.229364831516781,0.593087846879739,0.546586032456062,0.566086440831409,0.432128433829188,0.593215085663817,0.582149265030907,0.418276628023249,0.833962644210076,0.592009505642889,0.423798109763469,0.579541796586888,0.689689223676536,0.683835091239982,0.75382781490664,0.666264569236486,0.758906712740276,0.433289908901248,0.683390866904353,0.235431890499067],[0.986561983605754,0.999266961028813,0.936786136339561,0.998217177925044,0.837532088489014,0.999937922728911,0.999981051441437,0.999639518417918,0.999993916235397,0.999993060033348,0.77006696019338,0.999983190185955,0.999972075142162,0.847239491921556,0.999987346431528,0.999845939069467,0.643878796748148,0.964386134486062,0.83270912422141,0.922999579139196,0.827604129777636,0.82017190684077,0.999988850487344,0.962637167104431,0.999970404236145,0.999983216955274,0.999976739442713,0.999972537622677,0.99997805530862,0.999987049346493,0.937157029541736,0.923954843188372,0.994698148834903,0.970223337335562,0.999821366337978,0.923734848802669,0.999989969910109,0.999903635505402,0.999991562168799,0.828808260544693,0.99994018912658,0.999723389551482,0.999979843433919,0.994805429904486,0.999994031326652,0.888569562433017,0.985178207968925,0.975589091835673,0.999992760753718,0.999968735928133,0.99995901653084,0.999832876160126,0.999993440844028,0.998205491818663,0.99996948541583,0.999927422892311,0.999560774633163,0.999973855621361,0.999673621869998,0.99447679772507,0.990618678897266,0.999975210993583,0.999972035915143,0.875628615586715,0.997062459761317,0.624607784641511,0.999517992606141,0.999962427252987,0.999995778080903,0.999930230106458,0.999999121724873,0.999981082954441,0.999890056171324,0.690285604315168,0.676327605123576,0.659974420047968,0.999983080801903,0.998614614412249,0.999807597877239,0.887627032168707,0.684447876360913,0.648039512302804,0.882218179168604,0.996814163585211,0.999146753665472,0.904277832250577,0.747895061397418,0.9998067969245,0.932914025121884,0.999949180532792,0.999942619098504,0.999922753084285,0.999187766190601,0.973744006753107,0.999972133609657,0.69205056082197,0.883439957119733,0.703747009224144,0.967548014602149,0.854175667781702,0.969371054691337,0.668682793442738,0.999908749756506,0.999991307171192,0.999997517465869,0.969876199434581,0.999978982195214,0.999997646954886,0.999934011313168,0.985067015550084,0.999985577650508,0.999967773783333,0.999983168577108,0.975333559498528,0.999888753696708,0.864001178119067,0.999932405626841,0.99998355059096,0.999950714587274,0.970177423631636,0.999990500786284,0.999985030961673,0.999985492737084,0.848003100412221,0.921433764378199,0.920612769159211,0.999989284233066,0.999948544952432,0.999954642124209,0.999998041413951,0.799120673356471,0.999975783276639,0.999958282019722,0.865454213668335,0.758220902848378,0.746078910808662,0.961606823316384,0.545226462692578,0.997953153245138,0.686176487482559,0.999965109973601,0.991479288546911,0.999998190832071,0.98088179998655,0.999998457195649,0.999994403401917,0.999820106450961,0.999974537994793,0.999999956437351,0.99992553072241,0.899429286239827,0.778790985942756,0.999882014154946,0.999964154958862,0.940471657576028,0.981505725559467,0.855285969167214,0.999989480716606,0.862982359394662,0.865939705588606,0.999950094463238,0.888206477295755,0.817161396149882,0.99995930582897,0.963455526730495,0.999865939752206,0.999777545235652,0.999896217506571,0.99975721476218,0.99999801502062,0.999996641250202,0.999993323258271,0.999869368130978,0.999993878170402,0.807412482765747,0.927128507604234,0.903122568843199,0.99981037260952,0.848064530063477,0.944930910777465,0.999972374528423,0.999950487967503,0.91412654492648,0.974768228299595,0.881336805013375,0.530064819193199,0.999996692934028,0.999999190936001,0.999999583986559,0.999998828940581,0.999990564791165,0.688337198998639,0.985282909461283,0.99418368064041,0.999946786266324,0.999709613357537,0.999980054620792,0.999967448887763,0.929762285708943,0.74884288782978,0.913718243743957,0.999987809109722,0.998842119030646,0.702244970477885,0.999991589686547,0.952077069809666,0.963040781074052,0.999792344667459,0.999979680070792,0.999975807804608,0.905165310440961,0.82024616578695,0.983715956005467,0.999757523188179,0.848541354298661,0.999950747757807,0.9734064940838,0.999951387157151,0.999950036739921,0.982456447325437,0.999994480857746,0.999975412685948,0.99999134781353,0.999993814662638,0.999854345239188,0.663234195891871,0.999953516300351,0.999977424351348,0.999944128965993,0.999974080548551,0.999914115470436,0.999992889695552,0.999932006541803,0.999989567864873,0.999973692920266,0.867969207101538,0.799906962500193,0.925228512454508,0.99999765245018,0.999822854542363,0.999804772270364,0.999970068918696,0.999955804888955,0.99983270562757,0.683084393282235,0.91296189478204,0.998979541926209,0.999963268900361,0.999966499529586,0.999997717019798,0.693689511793157,0.691395304502049,0.906328182177733,0.909535198453123,0.910607759126776,0.8589217625976,0.94471310657873,0.966127231823087,0.999417112587532,0.902295425213118,0.999871966987928,0.999992436375984,0.999999446334547,0.868932043596152,0.999974842084473,0.999996940904852,0.999984436584552,0.999997241091657,0.999937818407755,0.9999138520484,0.999956918184799,0.926905941013729,0.863953536187495,0.999996148536351,0.999831556249717,0.999990450558182,0.999817668201354,0.89638434095905,0.999958202195278,0.874050723679815,0.999987598287874,0.999984712044903,0.897163741591328,0.999983412878366,0.999950211169159,0.95944154953634,0.999973913117698,0.99998013520619,0.99995925392064,0.999241607412672,0.999967403639378,0.999962470259902,0.999947723935802,0.646065561618573,0.999962021359378,0.999984174761756,0.99999008328338,0.99998928943895,0.999972352176949,0.999973653054732,0.999993125290303,0.999996826885828,0.980795064196394,0.804100599297711,0.682457335611585,0.302261550552682,0.999997299829829,0.999992377359675,0.999990375023693,0.999998099288251,0.999965659827224,0.999742233776726,0.998653369212788,0.999237662062063,0.940710413130578,0.803477928741155,0.789998002763329,0.793245852013263,0.947661129758518,0.999963456718296,0.949724857937742,0.99979400145505,0.513665017227917,0.99995427733498,0.9126980411637,0.999833065869855,0.844606190662934,0.999998291992104,0.999992689266594,0.999604699565453,0.999960560680531,0.999929621079374,0.999922042863434,0.954825912653464,0.999983523076456,0.885351209362138,0.815997915992504,0.999961944239352,0.999999787843862,0.887053938887285,0.999996302645773,0.824347010417083,0.991510822832628,0.99858200030988,0.999784654606745,0.99940687635682,0.999974563852341,0.999879242406846,0.998611806542499,0.999995288250152,0.999974065993949,0.999952996340283,0.999977467799835,0.999937948249024,0.999979456810873,0.999976668552918,0.999910230785577,0.999995885118461,0.999969358154195,0.999976545683812,0.999968153992547,0.999952853406319,0.759788925522164,0.774529268526255,0.980536595859849,0.942124005752924,0.942554561646108,0.787662301269586,0.999977132665547,0.999934486366456,0.887712137085969,0.999906482370781,0.705094463653141,0.684331126233122,0.675201011747388,0.681551856677726,0.69200734757183,0.898728840398517,0.999903197963505,0.914440138453636,0.907971003089735,0.892504990472921,0.689827874860881,0.999939078927399,0.995192438353537,0.689892982544741,0.928590727576672,0.999998608324128,0.999988391396145,0.999993010096172,0.999569100187311,0.964059163910028,0.844142041532484,0.989108429837429,0.825134963889396,0.954423148486093,0.999998311105458,0.999724609307629,0.999935054055308,0.990539372915565,0.999916099486367,0.806443704497459,0.965920433564226,0.999894880301484,0.940373011593838,0.999986478734346,0.99993098933034,0.947153004910465,0.999925307564177,0.99983072979297,0.999947409504283,0.999924306592581,0.999973105806827,0.99882446358751,0.999998240724964,0.99994929452095,0.578605296571877,0.999971460259223,0.840997383074148,0.999979091723797,0.680025303567136,0.999986567400044,0.999938870143434,0.937775027184511,0.871772488454777,0.744528908264995,0.631742142738428,0.971871892389248,0.99916996341875,0.999914327505956,0.999570404550045,0.883551534379506,0.999955977099306,0.894065802659992,0.999899718247982,0.999846994201116,0.903802036308471,0.899541744822427,0.999981831247923,0.999976680559698,0.87382786714501,0.880010621383177,0.999985146839023,0.872041979922052,0.999999288362403,0.894616743996212,0.90383781981515,0.999870915900171,0.895717404093504,0.999983126198336,0.905137574122249,0.999951028785458,0.999935138831839,0.999807914038851,0.999965623060225,0.999989776020266,0.999848388850206,0.892897572977592,0.999933699278505,0.997949764520265,0.660135999332262,0.998283607290952,0.973143460843175,0.983666241031733,0.900985342990593,0.999190062611386,0.999613639013209,0.877970122210772,0.999988293639788,0.999997540574563,0.887379516223358,0.999091525305047,0.999944508349728,0.999974801630894,0.999999692845666,0.999473331609269,0.999996197223171,0.892503129442288,0.999861367240782,0.668532143672748],["day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","day","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night","night"],["1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>DepthBin<\/th>\n      <th>BinMidPoint<\/th>\n      <th>lowerCI<\/th>\n      <th>meanPsi<\/th>\n      <th>upperCI<\/th>\n      <th>TimeOfDay<\/th>\n      <th>MorphoGroup<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb4" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> Morphogroup Occupancy Model</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu"># Methodology:</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>The full rationale and background on site-occupancy modelling can be found <span class="co">[</span><span class="ot">here</span><span class="co">](./main_05_all-copepod-occupancy.qmd)</span>. Following the verification of the technique, we applied these models to determine water column occupancy for each of the different morphogroups. This model followed the same structure as the all-copepod model, where occupancy ($\psi$) was assumed to be a unique, independent probability for each depth-bin and each morphogroup. As such this is a simple extension of the previous model, just ran for each individual morphogroup at site $i$, in depth-bin $db$, at each time of day $tod$. Again these models were ran separately for the epipelagic, upper mesopelagic, and low mesopelagic. </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>Y_{ij,db,tod,mg} \sim Bernoilli(p_{ij,tod,mg}*z_{i,db,tod,mg})</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>z_{i,db,tod,mg} \sim Binomial(\psi_{db,tod,mg})</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>logit(p_{ij,tod,mg}) \sim a_0 + a_{vs,tod,mg} * vs_{ij}</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>The same priors were used in this model as described previously. All model conditions and MCMC simulation methods were consistent as well.</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="fu"># Key Figures and Takeaways:</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=10}</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wiqid)</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(EcotaxaTools)</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">'../R/tools.R'</span>)</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>db <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">'../data/05_db-list.rds'</span>)</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>epi_mod_output <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">'../data/05_cluster-occ-mod-epi.rds'</span>)</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>tmeso_mod_output <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">'../data/05_cluster-occ-mod-tmeso.rds'</span>)</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>bmeso_mod_output <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">'../data/05_cluster-occ-mod-bmeso.rds'</span>)</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a><span class="co"># |- Extact credible intervals from models -------------</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>psi_extract <span class="ot">&lt;-</span> <span class="cf">function</span>(model, tod, min_d, max_d, <span class="at">db =</span> db) {</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>  db_length <span class="ot">&lt;-</span> <span class="fu">ncol</span>(model[[tod]]<span class="sc">$</span>sims.list<span class="sc">$</span>psi)</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>  out_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">db =</span> <span class="fu">db_decode</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>db_length), tod, min_d, max_d, <span class="at">db =</span> db),</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, db_length),</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">low =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, db_length),</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">high =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, db_length)</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>db_length) {</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>    out_df[i,<span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(model[[tod]]<span class="sc">$</span>sims.list<span class="sc">$</span>psi[,i]),</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">hdi</span>(model[[tod]]<span class="sc">$</span>sims.list<span class="sc">$</span>psi[,i]))</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out_df)</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>occ_pred <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">'list'</span>, <span class="dv">4</span>)</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(tod <span class="cf">in</span> <span class="fu">c</span>(<span class="st">'day'</span>, <span class="st">'night'</span>)) {</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>    occ_pred[[i]][[tod]] <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind,<span class="fu">list</span>(</span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>      <span class="fu">psi_extract</span>(epi_mod_output[[i]],</span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>                  tod, <span class="dv">0</span>, <span class="dv">200</span>,</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>                  <span class="at">db =</span> db[[i]]),</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>      <span class="fu">psi_extract</span>(tmeso_mod_output[[i]],</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>                  tod, <span class="dv">200</span>, <span class="dv">600</span>,</span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>                  <span class="at">db =</span> db[[i]]),</span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>      <span class="fu">psi_extract</span>(bmeso_mod_output[[i]],</span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>                  tod, <span class="dv">600</span>, <span class="dv">1200</span>,</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>                  <span class="at">db =</span> db[[i]]))) <span class="sc">|&gt;</span> </span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bin_format</span>()</span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(occ_pred) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>occ_pred <span class="ot">&lt;-</span> occ_pred <span class="sc">|&gt;</span> </span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(list_to_tib, <span class="st">'tod'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list_to_tib</span>(<span class="st">'cluster'</span>)</span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting ######</span></span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>ribbon_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(cluster) {</span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>  plot_data <span class="ot">&lt;-</span> occ_pred[occ_pred<span class="sc">$</span>cluster <span class="sc">==</span> cluster,]</span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>  out_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data) <span class="sc">+</span></span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> mp,</span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y =</span> mean,</span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ymin =</span> low,</span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ymax =</span> high,</span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fill =</span> tod,</span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color =</span> tod),</span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a>                <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> mp,</span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> mean,</span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> tod),</span>
<span id="cb4-100"><a href="#cb4-100" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb4-101"><a href="#cb4-101" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> .<span class="dv">75</span>) <span class="sc">+</span></span>
<span id="cb4-102"><a href="#cb4-102" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>tod)<span class="sc">+</span></span>
<span id="cb4-103"><a href="#cb4-103" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_reverse</span>() <span class="sc">+</span></span>
<span id="cb4-104"><a href="#cb4-104" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(dn_cols[<span class="st">'day'</span>],dn_cols[<span class="st">'night'</span>])) <span class="sc">+</span></span>
<span id="cb4-105"><a href="#cb4-105" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(dn_cols[<span class="st">'day'</span>],dn_cols[<span class="st">'night'</span>])) <span class="sc">+</span></span>
<span id="cb4-106"><a href="#cb4-106" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb4-107"><a href="#cb4-107" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_pubr</span>() <span class="sc">+</span></span>
<span id="cb4-108"><a href="#cb4-108" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Depth [m]'</span>, <span class="at">y =</span> <span class="st">"Occupancy"</span>) <span class="sc">+</span></span>
<span id="cb4-109"><a href="#cb4-109" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>,</span>
<span id="cb4-110"><a href="#cb4-110" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>))</span>
<span id="cb4-111"><a href="#cb4-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out_plot)</span>
<span id="cb4-112"><a href="#cb4-112" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-113"><a href="#cb4-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-114"><a href="#cb4-114" aria-hidden="true" tabindex="-1"></a><span class="co"># point_plot &lt;- function(cluster) {</span></span>
<span id="cb4-115"><a href="#cb4-115" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot_data &lt;- occ_pred[occ_pred$cluster == cluster,]</span></span>
<span id="cb4-116"><a href="#cb4-116" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb4-117"><a href="#cb4-117" aria-hidden="true" tabindex="-1"></a><span class="co">#   out_plot &lt;- ggplot(plot_data) +</span></span>
<span id="cb4-118"><a href="#cb4-118" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_pointrange(aes(x = mp,</span></span>
<span id="cb4-119"><a href="#cb4-119" aria-hidden="true" tabindex="-1"></a><span class="co">#                         y = mean,</span></span>
<span id="cb4-120"><a href="#cb4-120" aria-hidden="true" tabindex="-1"></a><span class="co">#                         ymin = low,</span></span>
<span id="cb4-121"><a href="#cb4-121" aria-hidden="true" tabindex="-1"></a><span class="co">#                         ymax = high,</span></span>
<span id="cb4-122"><a href="#cb4-122" aria-hidden="true" tabindex="-1"></a><span class="co">#                         color = tod),</span></span>
<span id="cb4-123"><a href="#cb4-123" aria-hidden="true" tabindex="-1"></a><span class="co">#                     position = position_dodge(width = 5)) +</span></span>
<span id="cb4-124"><a href="#cb4-124" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_x_reverse() +</span></span>
<span id="cb4-125"><a href="#cb4-125" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_fill_manual(values = c(dn_cols['day'],dn_cols['night'])) +</span></span>
<span id="cb4-126"><a href="#cb4-126" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_color_manual(values = c(dn_cols['day'],dn_cols['night'])) +</span></span>
<span id="cb4-127"><a href="#cb4-127" aria-hidden="true" tabindex="-1"></a><span class="co">#     coord_flip()+</span></span>
<span id="cb4-128"><a href="#cb4-128" aria-hidden="true" tabindex="-1"></a><span class="co">#     theme_pubr() +</span></span>
<span id="cb4-129"><a href="#cb4-129" aria-hidden="true" tabindex="-1"></a><span class="co">#     labs(x = 'Depth [m]', y = "Occupancy") +</span></span>
<span id="cb4-130"><a href="#cb4-130" aria-hidden="true" tabindex="-1"></a><span class="co">#     theme(legend.position = 'none')</span></span>
<span id="cb4-131"><a href="#cb4-131" aria-hidden="true" tabindex="-1"></a><span class="co">#   return(out_plot)</span></span>
<span id="cb4-132"><a href="#cb4-132" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb4-133"><a href="#cb4-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-134"><a href="#cb4-134" aria-hidden="true" tabindex="-1"></a>ribbon_occupancy <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">'list'</span>,<span class="dv">4</span>)</span>
<span id="cb4-135"><a href="#cb4-135" aria-hidden="true" tabindex="-1"></a><span class="co"># point_occupancy &lt;- vector('list', 4)</span></span>
<span id="cb4-136"><a href="#cb4-136" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb4-137"><a href="#cb4-137" aria-hidden="true" tabindex="-1"></a>  ribbon_occupancy[[i]] <span class="ot">&lt;-</span> <span class="fu">ribbon_plot</span>(i)</span>
<span id="cb4-138"><a href="#cb4-138" aria-hidden="true" tabindex="-1"></a>  <span class="co"># point_occupancy[[i]] &lt;- point_plot(i)</span></span>
<span id="cb4-139"><a href="#cb4-139" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-140"><a href="#cb4-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-141"><a href="#cb4-141" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page-outset</span></span>
<span id="cb4-142"><a href="#cb4-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-143"><a href="#cb4-143" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(ribbon_occupancy[[<span class="dv">1</span>]],</span>
<span id="cb4-144"><a href="#cb4-144" aria-hidden="true" tabindex="-1"></a>          ribbon_occupancy[[<span class="dv">2</span>]] <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb4-145"><a href="#cb4-145" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>()),</span>
<span id="cb4-146"><a href="#cb4-146" aria-hidden="true" tabindex="-1"></a>          ribbon_occupancy[[<span class="dv">3</span>]] <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb4-147"><a href="#cb4-147" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>()),</span>
<span id="cb4-148"><a href="#cb4-148" aria-hidden="true" tabindex="-1"></a>          ribbon_occupancy[[<span class="dv">4</span>]] <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb4-149"><a href="#cb4-149" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>()),</span>
<span id="cb4-150"><a href="#cb4-150" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb4-151"><a href="#cb4-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-152"><a href="#cb4-152" aria-hidden="true" tabindex="-1"></a><span class="co"># ggarrange(point_occupancy[[1]],</span></span>
<span id="cb4-153"><a href="#cb4-153" aria-hidden="true" tabindex="-1"></a><span class="co">#           point_occupancy[[2]] + theme(axis.title.y = element_blank()),</span></span>
<span id="cb4-154"><a href="#cb4-154" aria-hidden="true" tabindex="-1"></a><span class="co">#           point_occupancy[[3]] + theme(axis.title.y = element_blank()),</span></span>
<span id="cb4-155"><a href="#cb4-155" aria-hidden="true" tabindex="-1"></a><span class="co">#           point_occupancy[[4]] + theme(axis.title.y = element_blank()),</span></span>
<span id="cb4-156"><a href="#cb4-156" aria-hidden="true" tabindex="-1"></a><span class="co">#           ncol = 4)</span></span>
<span id="cb4-157"><a href="#cb4-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-158"><a href="#cb4-158" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb4-159"><a href="#cb4-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-160"><a href="#cb4-160" aria-hidden="true" tabindex="-1"></a>Generally, across all morphogroups, it can be seen that the credible intervals (95% high density interval of the posterior distribution) for copepod occupancy are very wide. Often ranging from 25% to 100%. However, there are some clear trends consistent with DVM hypotheses. Notably, there is an increased nighttime occupancy for all morphogroups from the 40m to 140m. For depth bins in those regions, the mean posterior occupancy ranged from 71% to 88%, indicating there is a high likelihood all morphogroups will be found in that region at night. There is lower daytime occupancy over that same region, however this varies by morphogroup. Notably, morphogroup 4 has a 54% mean posterior daytime occupancy from 40m-140m. This indicates a decreased likely of the larger morphogroup 4 copepods in that area during daytime. All other morphogroups have higher posterior daytime occupancy rates in the epipelagic. Generally throughout the rest of the water column, the posterior estimates of occupancy are consistent, except for a decline around 225-300m which is consistent with the abundance profiles. Overall, morphogroup 4 had a wider credible interval around the posterior occupancy estimate which is likely due to it's rarity.</span>
<span id="cb4-161"><a href="#cb4-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-162"><a href="#cb4-162" aria-hidden="true" tabindex="-1"></a>\n\n</span>
<span id="cb4-163"><a href="#cb4-163" aria-hidden="true" tabindex="-1"></a>A possilbe reason for the wide range of occupancy variables is the fact we have yet to account for environmental influences on occupancy across different cruises (sites). This is investigated in <span class="co">[</span><span class="ot">Figure 7</span><span class="co">](./main_07_environmental-effect-model.html)</span></span>
<span id="cb4-164"><a href="#cb4-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-165"><a href="#cb4-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-166"><a href="#cb4-166" aria-hidden="true" tabindex="-1"></a>The full occupancy credible intervals for each morphotype and depthbin can be seen below:</span>
<span id="cb4-167"><a href="#cb4-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-170"><a href="#cb4-170" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb4-171"><a href="#cb4-171" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb4-172"><a href="#cb4-172" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb4-173"><a href="#cb4-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-174"><a href="#cb4-174" aria-hidden="true" tabindex="-1"></a>occ_pred <span class="sc">|&gt;</span> </span>
<span id="cb4-175"><a href="#cb4-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">DepthBin =</span> db, <span class="at">BinMidPoint =</span> mp,</span>
<span id="cb4-176"><a href="#cb4-176" aria-hidden="true" tabindex="-1"></a>         <span class="at">lowerCI =</span> low, <span class="at">meanPsi =</span> mean, <span class="at">upperCI =</span> high, <span class="at">TimeOfDay =</span> tod, </span>
<span id="cb4-177"><a href="#cb4-177" aria-hidden="true" tabindex="-1"></a>         <span class="at">MorphoGroup =</span> cluster) <span class="sc">|&gt;</span> </span>
<span id="cb4-178"><a href="#cb4-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>(<span class="at">filter =</span> <span class="st">'top'</span>)</span>
<span id="cb4-179"><a href="#cb4-179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>